---
title: "Proyecto personal análisis de datos"
author: "Eduardo Sánchez"
date: "`r Sys.Date()`"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Habilita librerías
library(readxl) # Para importar datos a R

library(dplyr) # Para manipular datos

library(ggplot2) # Para hacer gráficos

library(tidyr) # Para manipular datos
```

## Análisis Exploratorio de Datos de Metaloproteasas

### Importación de datos

A partir del set de datos _MetalloproteasesDB_, se crea el objeto denominado _Datos_Metaloproteasas_, especificando que para los valores faltantes se emplea la nomenclatura N/A, y se observan los datos contenidos en este.

```{r}
Datos_Metaloproteasas <- read_excel("MetalloproteasesDB.xlsx", na = "N/A")

summary(Datos_Metaloproteasas)

str(Datos_Metaloproteasas)
```

### Transformación de datos

Del objeto _Datos_Metaloproteasas_, se transforman las variables _ID_, _Acc_No_, _Family_, _Keratinolytic_activity_, _Activity_type_, _Active_site_ y _Metal_binding_site_ a factores. Posteriormente, se explora nuevamente el set de datos para verificar.

```{r}
Datos_Metaloproteasas$ID <- as.factor(Datos_Metaloproteasas$ID)

Datos_Metaloproteasas$Acc_No <- as.factor(Datos_Metaloproteasas$Acc_No)

Datos_Metaloproteasas$Family <- as.factor(Datos_Metaloproteasas$Family)

Datos_Metaloproteasas$Keratinolytic_activity <- as.factor(Datos_Metaloproteasas$Keratinolytic_activity)

Datos_Metaloproteasas$Activity_type <- as.factor(Datos_Metaloproteasas$Activity_type)

Datos_Metaloproteasas$Active_site <- as.factor(Datos_Metaloproteasas$Active_site)

Datos_Metaloproteasas$Metal_binding_site <- as.factor(Datos_Metaloproteasas$Metal_binding_site)

summary(Datos_Metaloproteasas)
```
A partir de esta transformación y su posterior verificación, logra identificarse que hay un dato faltante tanto para _Active_site_ como para _Metal_binding_site_.

### Normalización de datos

Con el fin de minimizar la influencia de la longitud de la secuencia aminoacídica (_Lenght_) en las variables _Negative_AA_ y _Positive_AA_, se llevó a cabo la normalización de dichos parámetros mediante el cálculo de las variables derivadas _Negativity_ y _Positivity_ expresadas en proporciones.
#Cómo agregar al set de datos?

```{r}

Datos_Metaloproteasas %>% select(Length, Negative_AA) %>% 
  mutate(Negativity = Negative_AA/Length)

Datos_Metaloproteasas %>% select(Length, Positive_AA) %>% 
  mutate(Positivity = Positive_AA/Length)

```
### Balance de datos
Con el fin de identificar si los datos están balanceados o no entre tratamientos, se crearon tablas de frecuencia para estos, las cuales se muestran a continuación:


```{r}

#Knitrkabletable?
#table(tidy_vacunas$Group,tidy_vacunas$Week)

#b) Filtrar datos por un criterio de clasificación
#tidy_vacunas %>% filter(Group == "Vaccinated")

#c) Filtrar datos por dos criterios de clasificación
#tidy_vacunas %>% filter(Group == "Vaccinated") %>% filter(Week == 24)

#d) Calcular medidas resumen
#tidy_vacunas %>% filter(Group == "No-vaccinated") %>% summarize(mean(`IFN response`))

#Del conjunto de datos tidy_vacunas seleccione el grupo No-vaccinated y calcule para la variable IFN response el número de datos n(), el promedio mean(), la mediana median(), el valor mínimo min(), máximo max() y la desviación estándar sd().
#tidy_vacunas %>% filter(Group == "No-vaccinated") %>% summarize(n(), mean(`IFN response`),median(`IFN response`), min(`IFN response`), max(`IFN response`), sd(`IFN response`))

#cambie los títulos de cada columna agregando al código anterior un nuevo nombre entre comillas. Siga este ejemplo para la primera columna summarize(“N” = n() y complete para las columnas restantes.
#tidy_vacunas %>% filter(Group == "No-vaccinated") %>% summarize("N" = n(), "Mean"= mean(`IFN response`), "Median"= median(`IFN response`), "Minimum" = min(`IFN response`), "Maximum" = max(`IFN response`), "Standard Deviation" = sd(`IFN response`))

#Finalmente, para publicar una tabla resumen de forma profesional debemos crear un objeto llamado Table, almacenar nuestra última tabla resumen en el y luego imprimirla con el comando knitr::kable() de la librería knitr.
#Table <- tidy_vacunas %>% filter(Group == "No-vaccinated") %>% summarize("N" = n(), "Mean"= mean(`IFN response`), "Median"= median(`IFN response`), "Minimum" = min(`IFN response`), "Maximum" = max(`IFN response`), "Standard Deviation" = sd(`IFN response`))

#knitr::kable(Table, caption = "Tabla 1. Resumen de respuesta de IFN en animales no vacunados.")

table(Datos_Metaloproteasas$Keratinolytic_activity)

```


### Variación de las variables de estudio

A partir del set de datos se obtienen los histogramas correspondientes para analizar la variación de cada una de las variables de estudio.

#### Peso Molecular
```{r}
ggplot(Datos_Metaloproteasas, aes(x = Mol_Weight, color = Keratinolytic_activity)) +
  geom_histogram(position = "identity", bins = 8, alpha = 0.3)
```
#### Punto Isoeléctrico

```{r}
ggplot(Datos_Metaloproteasas, aes(x = pI, color = Keratinolytic_activity)) +
  geom_histogram(position = "identity", bins = 8, alpha = 0.3)
```
#### Negatividad

```{r}
ggplot(Datos_Metaloproteasas, aes(x = Negativity, color = Keratinolytic_activity)) +
  geom_histogram(position = "identity", bins = 8, alpha = 0.3)
```

#### Positividad

```{r}
ggplot(Datos_Metaloproteasas, aes(x = Positivity, color = Keratinolytic_activity)) +
  geom_histogram(position = "identity", bins = 8, alpha = 0.3)
```
#### Coeficiente de extinción

```{r}
ggplot(Datos_Metaloproteasas, aes(x = Extinction_coefficient , color = Keratinolytic_activity)) +
  geom_histogram(position = "identity", bins = 8, alpha = 0.3)
```

